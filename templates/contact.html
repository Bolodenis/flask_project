{% extends 'layout.html' %}

{% block title %}Fill Your Details for Catch-Up{% endblock %}

{% block content %}
    <h2 class="text-center my-5">Fill Your Details for Catch-Up!</h2>
    <section class="container my-5">
        <form method="POST" id="detailsForm">
            <!-- Surname and Email Section -->
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="inputSurname">Surname</label>
                    <input type="text" class="form-control" id="inputSurname" placeholder="Surname" name="surname" required>
                    <small class="text-danger d-none" id="surnameError">Please enter a valid surname (letters only).</small>
                </div>
                <div class="form-group col-md-6">
                    <label for="inputEmail4">Email</label>
                    <input type="email" class="form-control" id="inputEmail4" placeholder="Email" name="email" required>
                    <small class="text-danger d-none" id="emailError">Please enter a valid email.</small>
                </div>
            </div>
            
            <!-- Address Section -->
            <div class="form-group">
                <label for="inputAddress">Address</label>
                <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St" name="street" required>
            </div>
            <div class="form-group">
                <label for="inputAddress2">Address 2</label>
                <input type="text" class="form-control" id="inputAddress2" placeholder="Apartment, studio, or floor" name="apartment">
            </div>

            <!-- City Section -->
            <div class="form-group">
                <label for="inputCity">City</label>
                <input type="text" class="form-control" id="inputCity" name="city" required>
                <small class="text-danger d-none" id="cityError">Please enter a valid city (letters only).</small>
            </div>

            <!-- Submit Button -->
            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary btn-block">Submit</button>
            </div>
        </form>
    </section>

    <script>
        document.getElementById('detailsForm').addEventListener('submit', function(event) {
            let valid = true;

            // Surname validation: only letters
            const surnameInput = document.getElementById('inputSurname');
            const surnameError = document.getElementById('surnameError');
            const surnameRegex = /^[A-Za-z\s]+$/;
            if (!surnameRegex.test(surnameInput.value)) {
                surnameError.classList.remove('d-none');
                valid = false;
            } else {
                surnameError.classList.add('d-none');
            }

            // Email validation: handled by input type="email", but extra check can be added
            const emailInput = document.getElementById('inputEmail4');
            const emailError = document.getElementById('emailError');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(emailInput.value)) {
                emailError.classList.remove('d-none');
                valid = false;
            } else {
                emailError.classList.add('d-none');
            }

            // City validation: only letters
            const cityInput = document.getElementById('inputCity');
            const cityError = document.getElementById('cityError');
            const cityRegex = /^[A-Za-z\s]+$/;
            if (!cityRegex.test(cityInput.value)) {
                cityError.classList.remove('d-none');
                valid = false;
            } else {
                cityError.classList.add('d-none');
            }

            if (!valid) {
                event.preventDefault(); // Prevent form submission if validation fails
            }
        });
    </script>
{% endblock %}
